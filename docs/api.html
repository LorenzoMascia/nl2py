<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference - NL2Py Documentation</title>
    <meta name="description" content="Complete API reference for NL2Py Python library including classes, methods, and data structures.">
    <link rel="stylesheet" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <span>NL2Py</span>
        </a>
        <ul class="navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="getting-started.html">Getting Started</a></li>
            <li><a href="modules.html">Modules</a></li>
            <li><a href="architecture.html">Architecture</a></li>
            <li><a href="docker.html">Docker</a></li>
            <li><a href="api.html" class="active">API</a></li>
            <li><a href="https://github.com/lorenzomascia/nl2py" target="_blank">GitHub</a></li>
        </ul>
    </nav>

    <main>
        <div class="docs-layout">
            <!-- Sidebar -->
            <aside class="sidebar">
                <ul class="sidebar-nav">
                    <li class="section-title">Core Classes</li>
                    <li><a href="#nlpinterpreter">NLPInterpreter</a></li>
                    <li><a href="#fileinterpreter">FileInterpreter</a></li>
                    <li><a href="#matchresult">MatchResult</a></li>
                    <li class="section-title">Module Interface</li>
                    <li><a href="#modulebase">AIbasicModuleBase</a></li>
                    <li><a href="#modulemetadata">ModuleMetadata</a></li>
                    <li><a href="#methodinfo">MethodInfo</a></li>
                    <li class="section-title">Utility Functions</li>
                    <li><a href="#create-interpreter">create_interpreter()</a></li>
                    <li><a href="#collect-metadata">collect_all_modules_metadata()</a></li>
                    <li class="section-title">GUI</li>
                    <li><a href="#launch">launch()</a></li>
                    <li><a href="#create-gui">create_gui()</a></li>
                </ul>
            </aside>

            <!-- Content -->
            <div class="content">
                <h1>API Reference</h1>
                <p>Complete reference documentation for the NL2Py Python API.</p>

                <!-- NLPInterpreter -->
                <h2 id="nlpinterpreter">NLPInterpreter</h2>
                <p class="badge badge-primary">nl2py.nlp_interpreter</p>

                <p>Main class for interpreting natural language commands and generating Python code.</p>

                <h3>Constructor</h3>
                <pre><code>class NLPInterpreter:
    def __init__(self)</code></pre>

                <p>Creates a new interpreter instance. Call <code>load_modules()</code> before use.</p>

                <h3>Methods</h3>

                <h4>load_modules()</h4>
                <pre><code>def load_modules(
    self,
    module_classes: Optional[List[Any]] = None
) -> int</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>module_classes</code></td>
                            <td><code>Optional[List[Any]]</code></td>
                            <td>List of module classes to load. If None, loads all available modules.</td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Returns:</strong> Number of method examples loaded.</p>

                <pre><code># Load all modules
interpreter = NLPInterpreter()
count = interpreter.load_modules()
print(f"Loaded {count} examples")

# Load specific modules only
from nl2py.modules import AWSModule, GCPModule
interpreter.load_modules([AWSModule, GCPModule])</code></pre>

                <h4>interpret()</h4>
                <pre><code>def interpret(
    self,
    text: str
) -> Optional[MatchResult]</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>text</code></td>
                            <td><code>str</code></td>
                            <td>Natural language command to interpret.</td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Returns:</strong> <code>MatchResult</code> object or <code>None</code> if no match found.</p>

                <pre><code>result = interpreter.interpret("create s3 bucket my-data")
if result:
    print(result.generated_code)  # s3_create_bucket(name='my-data')
    print(result.similarity_score)  # 0.75</code></pre>

                <h4>match()</h4>
                <pre><code>def match(
    self,
    text: str,
    threshold: float = 0.1,
    top_k: int = 1
) -> List[MatchResult]</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>text</code></td>
                            <td><code>str</code></td>
                            <td>—</td>
                            <td>Natural language command to match.</td>
                        </tr>
                        <tr>
                            <td><code>threshold</code></td>
                            <td><code>float</code></td>
                            <td><code>0.1</code></td>
                            <td>Minimum similarity score (0-1).</td>
                        </tr>
                        <tr>
                            <td><code>top_k</code></td>
                            <td><code>int</code></td>
                            <td><code>1</code></td>
                            <td>Number of top matches to return.</td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Returns:</strong> List of <code>MatchResult</code> objects sorted by similarity.</p>

                <pre><code># Get top 5 matches for exploration
results = interpreter.match(
    "upload file to storage",
    threshold=0.05,
    top_k=5
)

for r in results:
    print(f"{r.method_name}: {r.similarity_score:.2f}")</code></pre>

                <!-- FileInterpreter -->
                <h2 id="fileinterpreter">FileInterpreter</h2>
                <p class="badge badge-primary">nl2py.nlp_interpreter</p>

                <p>Processes text files containing natural language commands.</p>

                <h3>Constructor</h3>
                <pre><code>class FileInterpreter:
    def __init__(
        self,
        interpreter: Optional[NLPInterpreter] = None
    )</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>interpreter</code></td>
                            <td><code>Optional[NLPInterpreter]</code></td>
                            <td>Existing interpreter instance. Creates new one if None.</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Methods</h3>

                <h4>process_file()</h4>
                <pre><code>def process_file(
    self,
    file_path: str,
    output_path: Optional[str] = None,
    threshold: float = 0.1,
    include_comments: bool = True
) -> str</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>file_path</code></td>
                            <td><code>str</code></td>
                            <td>—</td>
                            <td>Path to input text file.</td>
                        </tr>
                        <tr>
                            <td><code>output_path</code></td>
                            <td><code>Optional[str]</code></td>
                            <td><code>None</code></td>
                            <td>Path to write output. Returns string if None.</td>
                        </tr>
                        <tr>
                            <td><code>threshold</code></td>
                            <td><code>float</code></td>
                            <td><code>0.1</code></td>
                            <td>Minimum similarity threshold.</td>
                        </tr>
                        <tr>
                            <td><code>include_comments</code></td>
                            <td><code>bool</code></td>
                            <td><code>True</code></td>
                            <td>Include original text as comments.</td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Returns:</strong> Generated Python code as string.</p>

                <pre><code>fi = FileInterpreter()

# Process and write to file
fi.process_file("commands.txt", "output.py")

# Process and get string
code = fi.process_file("commands.txt")
print(code)</code></pre>

                <h4>process_lines()</h4>
                <pre><code>def process_lines(
    self,
    lines: List[str],
    threshold: float = 0.1
) -> List[Optional[MatchResult]]</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>lines</code></td>
                            <td><code>List[str]</code></td>
                            <td>List of natural language commands.</td>
                        </tr>
                        <tr>
                            <td><code>threshold</code></td>
                            <td><code>float</code></td>
                            <td>Minimum similarity threshold.</td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Returns:</strong> List of <code>MatchResult</code> or <code>None</code> for each line.</p>

                <pre><code>lines = [
    "create bucket my-data",
    "list all containers",
    "# this is a comment"
]
results = fi.process_lines(lines)

for line, result in zip(lines, results):
    if result:
        print(f"{line} -> {result.generated_code}")</code></pre>

                <!-- MatchResult -->
                <h2 id="matchresult">MatchResult</h2>
                <p class="badge badge-secondary">dataclass</p>

                <p>Contains the result of matching a natural language command.</p>

                <pre><code>@dataclass
class MatchResult:
    module_name: str        # Name of the matched module
    method_name: str        # Name of the matched method
    similarity_score: float # Similarity score (0-1)
    matched_example: str    # The example text that was matched
    extracted_params: Dict[str, str]  # Extracted parameters
    generated_code: str     # Generated Python code
    original_text: str      # Original input text</code></pre>

                <h3>Attributes</h3>

                <table>
                    <thead>
                        <tr><th>Attribute</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>module_name</code></td>
                            <td><code>str</code></td>
                            <td>Name of the module class (e.g., "GCPModule")</td>
                        </tr>
                        <tr>
                            <td><code>method_name</code></td>
                            <td><code>str</code></td>
                            <td>Name of the matched method</td>
                        </tr>
                        <tr>
                            <td><code>similarity_score</code></td>
                            <td><code>float</code></td>
                            <td>Cosine similarity score between 0 and 1</td>
                        </tr>
                        <tr>
                            <td><code>matched_example</code></td>
                            <td><code>str</code></td>
                            <td>The example text that produced the best match</td>
                        </tr>
                        <tr>
                            <td><code>extracted_params</code></td>
                            <td><code>Dict[str, str]</code></td>
                            <td>Dictionary of extracted parameter values</td>
                        </tr>
                        <tr>
                            <td><code>generated_code</code></td>
                            <td><code>str</code></td>
                            <td>The generated Python function call</td>
                        </tr>
                        <tr>
                            <td><code>original_text</code></td>
                            <td><code>str</code></td>
                            <td>The original input text</td>
                        </tr>
                    </tbody>
                </table>

                <pre><code>result = interpreter.interpret("create instance web-server in zone us-central1-a")

print(result.module_name)       # "GCPModule"
print(result.method_name)       # "compute_instance_create"
print(result.similarity_score)  # 0.85
print(result.matched_example)   # "create compute instance {{name}} in zone {{zone}}"
print(result.extracted_params)  # {"name": "web-server", "zone": "us-central1-a"}
print(result.generated_code)    # "compute_instance_create(name='web-server', zone='us-central1-a')"</code></pre>

                <!-- AIbasicModuleBase -->
                <h2 id="modulebase">AIbasicModuleBase</h2>
                <p class="badge badge-primary">nl2py.modules.module_base</p>

                <p>Abstract base class that all modules must implement.</p>

                <pre><code>from abc import ABC, abstractmethod

class AIbasicModuleBase(ABC):
    @classmethod
    @abstractmethod
    def get_metadata(cls) -> ModuleMetadata:
        """Return module metadata."""
        pass

    @classmethod
    @abstractmethod
    def get_usage_notes(cls) -> List[str]:
        """Return usage notes and tips."""
        pass

    @classmethod
    @abstractmethod
    def get_methods_info(cls) -> List[MethodInfo]:
        """Return method information with examples."""
        pass

    @classmethod
    def get_full_documentation(cls) -> Dict[str, Any]:
        """Return complete documentation dictionary."""
        pass</code></pre>

                <h3>Implementing a Module</h3>

                <pre><code>from nl2py.modules.module_base import (
    AIbasicModuleBase,
    ModuleMetadata,
    MethodInfo
)

class MyModule(AIbasicModuleBase):
    @classmethod
    def get_metadata(cls):
        return ModuleMetadata(
            name="My Module",
            task_type="my_task",
            description="Does something useful",
            version="1.0.0",
            keywords=["my", "module"],
            dependencies=["requests"]
        )

    @classmethod
    def get_usage_notes(cls):
        return [
            "Requires API key",
            "Rate limited to 100/min"
        ]

    @classmethod
    def get_methods_info(cls):
        return [
            MethodInfo(
                name="do_something",
                description="Performs an action",
                parameters={"param": "The parameter"},
                returns="Result dictionary",
                examples=[
                    {
                        "text": "do something with {{value}}",
                        "code": "do_something(param='{{value}}')"
                    }
                ]
            )
        ]</code></pre>

                <!-- ModuleMetadata -->
                <h2 id="modulemetadata">ModuleMetadata</h2>
                <p class="badge badge-secondary">dataclass</p>

                <p>Describes a module's metadata.</p>

                <pre><code>class ModuleMetadata:
    def __init__(
        self,
        name: str,
        task_type: str,
        description: str,
        version: str = "1.0.0",
        keywords: Optional[List[str]] = None,
        dependencies: Optional[List[str]] = None
    )</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>name</code></td>
                            <td><code>str</code></td>
                            <td>Human-readable module name</td>
                        </tr>
                        <tr>
                            <td><code>task_type</code></td>
                            <td><code>str</code></td>
                            <td>Unique identifier for the task type</td>
                        </tr>
                        <tr>
                            <td><code>description</code></td>
                            <td><code>str</code></td>
                            <td>Module description</td>
                        </tr>
                        <tr>
                            <td><code>version</code></td>
                            <td><code>str</code></td>
                            <td>Module version (default: "1.0.0")</td>
                        </tr>
                        <tr>
                            <td><code>keywords</code></td>
                            <td><code>List[str]</code></td>
                            <td>Keywords for discovery</td>
                        </tr>
                        <tr>
                            <td><code>dependencies</code></td>
                            <td><code>List[str]</code></td>
                            <td>Python package dependencies</td>
                        </tr>
                    </tbody>
                </table>

                <!-- MethodInfo -->
                <h2 id="methodinfo">MethodInfo</h2>
                <p class="badge badge-secondary">dataclass</p>

                <p>Describes a method with its parameters and NLP examples.</p>

                <pre><code>class MethodInfo:
    def __init__(
        self,
        name: str,
        description: str,
        parameters: Dict[str, str],
        returns: str,
        examples: Optional[List[Dict[str, str]]] = None
    )</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>name</code></td>
                            <td><code>str</code></td>
                            <td>Method name</td>
                        </tr>
                        <tr>
                            <td><code>description</code></td>
                            <td><code>str</code></td>
                            <td>Method description</td>
                        </tr>
                        <tr>
                            <td><code>parameters</code></td>
                            <td><code>Dict[str, str]</code></td>
                            <td>Parameter names mapped to descriptions</td>
                        </tr>
                        <tr>
                            <td><code>returns</code></td>
                            <td><code>str</code></td>
                            <td>Return value description</td>
                        </tr>
                        <tr>
                            <td><code>examples</code></td>
                            <td><code>List[Dict]</code></td>
                            <td>List of {"text": ..., "code": ...} examples</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Examples Format</h3>

                <pre><code>examples=[
    {
        "text": "create bucket {{name}}",
        "code": "create_bucket(name='{{name}}')"
    },
    {
        "text": "create bucket {{name}} in region {{region}}",
        "code": "create_bucket(name='{{name}}', region='{{region}}')"
    }
]</code></pre>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Use <code>{{placeholder}}</code> syntax for parameters. These are used for both matching and extraction.
                </div>

                <!-- Utility Functions -->
                <h2 id="create-interpreter">create_interpreter()</h2>
                <p class="badge badge-primary">nl2py.nlp_interpreter</p>

                <p>Factory function to create and initialize an interpreter.</p>

                <pre><code>def create_interpreter() -> NLPInterpreter</code></pre>

                <p><strong>Returns:</strong> Initialized <code>NLPInterpreter</code> with all modules loaded.</p>

                <pre><code>from nl2py import create_interpreter

interpreter = create_interpreter()
# Prints: "Loaded X method examples from modules"

result = interpreter.interpret("create s3 bucket")</code></pre>

                <h2 id="collect-metadata">collect_all_modules_metadata()</h2>
                <p class="badge badge-primary">nl2py.modules.module_base</p>

                <p>Collects metadata from all available modules.</p>

                <pre><code>def collect_all_modules_metadata() -> Dict[str, Dict[str, Any]]</code></pre>

                <p><strong>Returns:</strong> Dictionary mapping task types to full documentation.</p>

                <pre><code>from nl2py.modules.module_base import collect_all_modules_metadata

metadata = collect_all_modules_metadata()

for task_type, doc in metadata.items():
    print(f"{task_type}: {doc['metadata']['name']}")
    print(f"  Methods: {len(doc['methods'])}")</code></pre>

                <!-- GUI Functions -->
                <h2 id="launch">launch()</h2>
                <p class="badge badge-primary">nl2py.gui</p>

                <p>Launch the Gradio web interface.</p>

                <pre><code>def launch(
    share: bool = False,
    server_port: int = 7860,
    **kwargs
) -> None</code></pre>

                <table>
                    <thead>
                        <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>share</code></td>
                            <td><code>bool</code></td>
                            <td><code>False</code></td>
                            <td>Create a public share link</td>
                        </tr>
                        <tr>
                            <td><code>server_port</code></td>
                            <td><code>int</code></td>
                            <td><code>7860</code></td>
                            <td>Port to run the server on</td>
                        </tr>
                        <tr>
                            <td><code>**kwargs</code></td>
                            <td></td>
                            <td></td>
                            <td>Additional Gradio launch options</td>
                        </tr>
                    </tbody>
                </table>

                <pre><code>from nl2py.gui import launch

# Basic launch
launch()

# With public share link
launch(share=True)

# Custom port
launch(server_port=8080)</code></pre>

                <h2 id="create-gui">create_gui()</h2>
                <p class="badge badge-primary">nl2py.gui</p>

                <p>Create the Gradio interface without launching.</p>

                <pre><code>def create_gui() -> gr.Blocks</code></pre>

                <p><strong>Returns:</strong> Gradio Blocks application object.</p>

                <pre><code>from nl2py.gui import create_gui

app = create_gui()

# Customize before launch
app.queue()
app.launch(server_name="0.0.0.0")</code></pre>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>NL2Py</h4>
                <p style="color: var(--text-muted);">Natural Language to Python Compiler</p>
            </div>
            <div class="footer-section">
                <h4>Documentation</h4>
                <a href="getting-started.html">Getting Started</a>
                <a href="modules.html">Modules</a>
                <a href="architecture.html">Architecture</a>
                <a href="api.html">API Reference</a>
            </div>
            <div class="footer-section">
                <h4>Resources</h4>
                <a href="docker.html">Docker Deployment</a>
                <a href="https://github.com/lorenzomascia/nl2py" target="_blank">GitHub</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Released under the MIT License. © 2024 NL2Py Contributors.</p>
        </div>
    </footer>

    <script>
        // Active section highlighting based on scroll
        const sections = document.querySelectorAll('h2[id]');
        const sidebarLinks = document.querySelectorAll('.sidebar-nav a[href^="#"]');

        function updateActiveSection() {
            let currentSection = '';
            const scrollPosition = window.scrollY + 150;

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollPosition >= sectionTop) {
                    currentSection = section.getAttribute('id');
                }
            });

            sidebarLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + currentSection) {
                    link.classList.add('active');
                }
            });
        }

        // Update on scroll
        window.addEventListener('scroll', updateActiveSection);
        // Update on load
        updateActiveSection();

        // Smooth scroll on click
        sidebarLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    window.scrollTo({
                        top: targetSection.offsetTop - 100,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>
